---
layout: default
title: 时间流
permalink: /timeline/
---

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>时间流 - 文章归档</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 时间流样式 */
        .timeline-item {
            position: relative;
            padding-left: 40px;
            margin-bottom: 30px;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.6s ease forwards;
        }
        
        .timeline-item:nth-child(1) { animation-delay: 0.1s; }
        .timeline-item:nth-child(2) { animation-delay: 0.2s; }
        .timeline-item:nth-child(3) { animation-delay: 0.3s; }
        .timeline-item:nth-child(4) { animation-delay: 0.4s; }
        .timeline-item:nth-child(5) { animation-delay: 0.5s; }
        .timeline-item:nth-child(6) { animation-delay: 0.6s; }
        .timeline-item:nth-child(7) { animation-delay: 0.7s; }
        .timeline-item:nth-child(8) { animation-delay: 0.8s; }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 8px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .timeline-item::after {
            content: '';
            position: absolute;
            left: 5px;
            top: 20px;
            width: 2px;
            height: calc(100% + 10px);
            background: linear-gradient(180deg, rgba(102, 126, 234, 0.3) 0%, rgba(102, 126, 234, 0.1) 100%);
        }
        
        .timeline-item:last-child::after {
            display: none;
        }
        
        .timeline-content {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }
        
        .timeline-content:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: rgba(102, 126, 234, 0.3);
        }
        
        .timeline-date {
            color: #6b7280;
            font-size: 0.875rem;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .timeline-title {
            color: #1f2937;
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .timeline-excerpt {
            color: #6b7280;
            font-size: 0.875rem;
            line-height: 1.6;
        }
        
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* 热力图样式 */
        .heatmap-container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(53, 1fr);
            gap: 2px;
            margin-top: 16px;
        }
        
        .heatmap-cell {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }
        
        .heatmap-cell:hover {
            transform: scale(1.2);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            z-index: 10;
        }
        
        .heatmap-cell[data-level="0"] { background-color: #ebedf0; }
        .heatmap-cell[data-level="1"] { background-color: #c6e48b; }
        .heatmap-cell[data-level="2"] { background-color: #7bc96f; }
        .heatmap-cell[data-level="3"] { background-color: #239a3b; }
        .heatmap-cell[data-level="4"] { background-color: #196127; }
        
        .heatmap-months {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 8px;
            margin-bottom: 8px;
            font-size: 10px;
            color: #6b7280;
        }
        
        .heatmap-weekdays {
            display: flex;
            flex-direction: column;
            gap: 2px;
            margin-right: 8px;
            font-size: 10px;
            color: #6b7280;
            align-items: flex-end;
            padding-top: 16px;
        }
        
        .heatmap-wrapper {
            display: flex;
            align-items: flex-start;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .timeline-item {
                padding-left: 30px;
                margin-bottom: 20px;
            }
            
            .timeline-content {
                padding: 16px;
            }
            
            .heatmap-grid {
                grid-template-columns: repeat(26, 1fr);
                gap: 1px;
            }
            
            .heatmap-cell {
                width: 10px;
                height: 10px;
            }
            
            .heatmap-months {
                grid-template-columns: repeat(6, 1fr);
            }
        }
        
        /* 筛选面板样式 */
        .filter-panel {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(0, 0, 0, 0.1);
            z-index: 50;
            min-width: 320px;
            max-width: 400px;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            pointer-events: none;
        }
        
        .filter-panel.show {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }
        
        .filter-section {
            padding: 16px;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .filter-section:last-child {
            border-bottom: none;
        }
        
        .filter-title {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 12px;
        }
        
        .filter-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }
        
        .filter-btn {
            padding: 8px 12px;
            border: 1px solid #e5e7eb;
            background: white;
            border-radius: 8px;
            font-size: 13px;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }
        
        .filter-btn:hover {
            background: #f9fafb;
            border-color: #d1d5db;
        }
        
        .filter-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
        }
        
        .date-inputs {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .date-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 13px;
            color: #374151;
        }
        
        .date-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .view-toggle {
            display: flex;
            gap: 8px;
            padding: 4px;
            background: #f3f4f6;
            border-radius: 10px;
        }
        
        .view-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-size: 14px;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }
        
        .view-btn:hover {
            background: rgba(255, 255, 255, 0.5);
        }
        
        .view-btn.active {
            background: white;
            color: #374151;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        /* 统计信息样式 */
        .stats-container {
            display: flex;
            gap: 24px;
            margin-bottom: 16px;
            padding: 16px;
            background: #f9fafb;
            border-radius: 8px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            line-height: 1;
        }
        
        .stat-label {
            font-size: 12px;
            color: #6b7280;
            margin-top: 4px;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- 头部区域 -->
        <div class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">时间流</h1>
                <p class="text-gray-600">探索文章的时间脉络，发现创作的节奏</p>
            </div>
            
            <!-- 日历图标和筛选面板 -->
            <div class="relative">
                <button id="filterToggle" class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
                    <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                </button>
                
                <div id="filterPanel" class="filter-panel">
                    <!-- 快速筛选 -->
                    <div class="filter-section">
                        <div class="filter-title">快速筛选</div>
                        <div class="filter-buttons">
                            <button class="filter-btn" data-filter="7days">最近7天</button>
                            <button class="filter-btn" data-filter="30days">最近30天</button>
                            <button class="filter-btn" data-filter="90days">最近90天</button>
                            <button class="filter-btn" data-filter="1year">最近一年</button>
                            <button class="filter-btn" data-filter="2024">2024年</button>
                            <button class="filter-btn active" data-filter="all">全部时间</button>
                        </div>
                    </div>
                    
                    <!-- 年份筛选 -->
                    <div class="filter-section">
                        <div class="filter-title">按年份筛选</div>
                        <div class="filter-buttons" id="yearButtons">
                            <!-- 动态生成年份按钮 -->
                        </div>
                    </div>
                    
                    <!-- 月份筛选 -->
                    <div class="filter-section">
                        <div class="filter-title">按月份筛选</div>
                        <div class="filter-buttons" id="monthButtons">
                            <button class="filter-btn" data-month="1">1月</button>
                            <button class="filter-btn" data-month="2">2月</button>
                            <button class="filter-btn" data-month="3">3月</button>
                            <button class="filter-btn" data-month="4">4月</button>
                            <button class="filter-btn" data-month="5">5月</button>
                            <button class="filter-btn" data-month="6">6月</button>
                            <button class="filter-btn" data-month="7">7月</button>
                            <button class="filter-btn" data-month="8">8月</button>
                            <button class="filter-btn" data-month="9">9月</button>
                            <button class="filter-btn" data-month="10">10月</button>
                            <button class="filter-btn" data-month="11">11月</button>
                            <button class="filter-btn" data-month="12">12月</button>
                        </div>
                    </div>
                    
                    <!-- 自定义日期范围 -->
                    <div class="filter-section">
                        <div class="filter-title">自定义日期范围</div>
                        <div class="date-inputs">
                            <input type="date" id="startDate" class="date-input" placeholder="开始日期">
                            <span class="text-gray-500">至</span>
                            <input type="date" id="endDate" class="date-input" placeholder="结束日期">
                        </div>
                        <div class="mt-3 flex gap-2">
                            <button id="applyCustomRange" class="flex-1 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors text-sm">
                                应用筛选
                            </button>
                            <button id="clearFilter" class="flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors text-sm">
                                清除筛选
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 视图切换 -->
        <div class="flex justify-center mb-8">
            <div class="view-toggle">
                <button class="view-btn active" data-view="timeline">时间流</button>
                <button class="view-btn" data-view="heatmap">热力图</button>
            </div>
        </div>

        <!-- 时间流视图 -->
        <div id="timelineView" class="view-content">
            <div id="timelineContainer" class="space-y-8">
                <!-- 时间流项目将在这里动态生成 -->
            </div>
        </div>

        <!-- 热力图视图 -->
        <div id="heatmapView" class="view-content hidden">
            <div class="heatmap-container">
                <!-- 统计信息 -->
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="totalPosts">0</div>
                        <div class="stat-label">文章总数</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="activeDays">0</div>
                        <div class="stat-label">活跃天数</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="currentStreak">0</div>
                        <div class="stat-label">当前连续</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="longestStreak">0</div>
                        <div class="stat-label">最长连续</div>
                    </div>
                </div>

                <!-- 年份选择器 -->
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold text-gray-800">
                        <span id="heatmapYear">2024</span>年贡献热力图
                    </h3>
                    <div class="flex gap-2">
                        <button id="prevYear" class="px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors">
                            ←
                        </button>
                        <button id="nextYear" class="px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors">
                            →
                        </button>
                    </div>
                </div>

                <!-- 月份标签 -->
                <div class="heatmap-months" id="monthLabels">
                    <!-- 月份标签将在这里动态生成 -->
                </div>

                <!-- 热力图网格 -->
                <div class="heatmap-wrapper">
                    <div class="heatmap-weekdays">
                        <div>一</div>
                        <div>三</div>
                        <div>五</div>
                    </div>
                    <div class="heatmap-grid" id="heatmapGrid">
                        <!-- 热力图格子将在这里动态生成 -->
                    </div>
                </div>

                <!-- 图例 -->
                <div class="flex items-center justify-between mt-4 text-xs text-gray-600">
                    <span>少</span>
                    <div class="flex gap-1">
                        <div class="w-3 h-3 rounded-sm" style="background-color: #ebedf0;"></div>
                        <div class="w-3 h-3 rounded-sm" style="background-color: #c6e48b;"></div>
                        <div class="w-3 h-3 rounded-sm" style="background-color: #7bc96f;"></div>
                        <div class="w-3 h-3 rounded-sm" style="background-color: #239a3b;"></div>
                        <div class="w-3 h-3 rounded-sm" style="background-color: #196127;"></div>
                    </div>
                    <span>多</span>
                </div>
            </div>
        </div>

        <!-- 文章列表 -->
        <div id="articleList" class="mt-8 hidden">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">
                <span id="selectedDate"></span>的文章
            </h3>
            <div id="articleContainer" class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
                <!-- 文章卡片将在这里动态生成 -->
            </div>
        </div>
    </div>

    <script>
        // 文章数据
        const articles = [
            {
                title: "远程工作的思考",
                date: "2024-01-10",
                excerpt: "探讨远程工作的优势与挑战，以及如何提高远程工作效率...",
                url: "/2024/01/10/remote-work-thoughts.html",
                category: "生活"
            },
            {
                title: "React 18 新特性详解",
                date: "2024-01-15",
                excerpt: "深入了解React 18的新特性，包括并发渲染、自动批处理等...",
                url: "/tech/2024/01/15/react-18-new-features.html",
                category: "技术"
            }
        ];

        // 全局变量
        let currentView = 'timeline';
        let currentYear = new Date().getFullYear();
        let filteredArticles = [...articles];
        let currentFilter = null;

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            initializeFilterPanel();
            initializeViewToggle();
            renderTimeline();
            initializeHeatmap();
            updateStats();
            generateYearButtons();
        });

        // 初始化筛选面板
        function initializeFilterPanel() {
            const filterToggle = document.getElementById('filterToggle');
            const filterPanel = document.getElementById('filterPanel');
            
            // 切换筛选面板
            filterToggle.addEventListener('click', function(e) {
                e.stopPropagation();
                filterPanel.classList.toggle('show');
            });
            
            // 点击外部关闭面板
            document.addEventListener('click', function() {
                filterPanel.classList.remove('show');
            });
            
            filterPanel.addEventListener('click', function(e) {
                e.stopPropagation();
            });
            
            // 快速筛选按钮
            document.querySelectorAll('.filter-btn[data-filter]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const filter = this.dataset.filter;
                    applyFilter(filter, 'quick');
                    
                    // 更新按钮状态
                    document.querySelectorAll('.filter-btn[data-filter]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // 月份筛选按钮
            document.querySelectorAll('.filter-btn[data-month]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const month = parseInt(this.dataset.month);
                    applyMonthFilter(month);
                });
            });
            
            // 自定义日期范围
            document.getElementById('applyCustomRange').addEventListener('click', function() {
                const startDate = document.getElementById('startDate').value;
                const endDate = document.getElementById('endDate').value;
                if (startDate && endDate) {
                    applyCustomRangeFilter(startDate, endDate);
                }
            });
            
            // 清除筛选
            document.getElementById('clearFilter').addEventListener('click', function() {
                clearAllFilters();
            });
        }

        // 生成年份按钮
        function generateYearButtons() {
            const yearButtons = document.getElementById('yearButtons');
            const years = [...new Set(articles.map(article => new Date(article.date).getFullYear()))];
            
            years.sort((a, b) => b - a);
            
            years.forEach(year => {
                const btn = document.createElement('button');
                btn.className = 'filter-btn';
                btn.textContent = year + '年';
                btn.addEventListener('click', function() {
                    applyYearFilter(year);
                });
                yearButtons.appendChild(btn);
            });
        }

        // 应用筛选
        function applyFilter(filter, type) {
            const now = new Date();
            let startDate, endDate;
            
            switch(filter) {
                case '7days':
                    startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                    endDate = now;
                    break;
                case '30days':
                    startDate = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                    endDate = now;
                    break;
                case '90days':
                    startDate = new Date(now.getTime() - 90 * 24 * 60 * 60 * 1000);
                    endDate = now;
                    break;
                case '1year':
                    startDate = new Date(now.getTime() - 365 * 24 * 60 * 60 * 1000);
                    endDate = now;
                    break;
                case '2024':
                    startDate = new Date('2024-01-01');
                    endDate = new Date('2024-12-31');
                    break;
                case 'all':
                default:
                    filteredArticles = [...articles];
                    currentFilter = null;
                    updateViews();
                    return;
            }
            
            filterArticlesByDateRange(startDate, endDate);
        }

        // 按年份筛选
        function applyYearFilter(year) {
            const startDate = new Date(year, 0, 1);
            const endDate = new Date(year, 11, 31);
            filterArticlesByDateRange(startDate, endDate);
            
            // 更新热力图年份
            currentYear = year;
            renderHeatmap();
            
            // 更新按钮状态
            document.querySelectorAll('#yearButtons .filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // 按月份筛选
        function applyMonthFilter(month) {
            const year = currentYear;
            const startDate = new Date(year, month - 1, 1);
            const endDate = new Date(year, month, 0);
            filterArticlesByDateRange(startDate, endDate);
            
            // 更新按钮状态
            document.querySelectorAll('#monthButtons .filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // 自定义日期范围筛选
        function applyCustomRangeFilter(startDate, endDate) {
            const start = new Date(startDate);
            const end = new Date(endDate);
            filterArticlesByDateRange(start, end);
        }

        // 按日期范围筛选文章
        function filterArticlesByDateRange(startDate, endDate) {
            filteredArticles = articles.filter(article => {
                const articleDate = new Date(article.date);
                return articleDate >= startDate && articleDate <= endDate;
            });
            
            currentFilter = { startDate, endDate };
            updateViews();
        }

        // 清除所有筛选
        function clearAllFilters() {
            filteredArticles = [...articles];
            currentFilter = null;
            
            // 清除所有按钮状态
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector('.filter-btn[data-filter="all"]').classList.add('active');
            
            // 清除日期输入
            document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = '';
            
            updateViews();
        }

        // 更新视图
        function updateViews() {
            renderTimeline();
            renderHeatmap();
            updateStats();
        }

        // 初始化视图切换
        function initializeViewToggle() {
            const viewButtons = document.querySelectorAll('.view-btn');
            const timelineView = document.getElementById('timelineView');
            const heatmapView = document.getElementById('heatmapView');
            
            viewButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const view = this.dataset.view;
                    
                    // 更新按钮状态
                    viewButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 切换视图
                    if (view === 'timeline') {
                        timelineView.classList.remove('hidden');
                        heatmapView.classList.add('hidden');
                    } else {
                        timelineView.classList.add('hidden');
                        heatmapView.classList.remove('hidden');
                        renderHeatmap(); // 重新渲染热力图以确保正确显示
                    }
                    
                    currentView = view;
                });
            });
        }

        // 渲染时间流
        function renderTimeline() {
            const container = document.getElementById('timelineContainer');
            container.innerHTML = '';
            
            if (filteredArticles.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-500 py-8">暂无符合条件的文章</div>';
                return;
            }
            
            // 按日期排序（最新的在前）
            const sortedArticles = [...filteredArticles].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedArticles.forEach((article, index) => {
                const timelineItem = document.createElement('div');
                timelineItem.className = 'timeline-item';
                timelineItem.style.animationDelay = `${index * 0.1}s`;
                
                const date = new Date(article.date);
                const formattedDate = `${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日`;
                
                timelineItem.innerHTML = `
                    <div class="timeline-content">
                        <div class="timeline-date">${formattedDate}</div>
                        <div class="timeline-title">${article.title}</div>
                        <div class="timeline-excerpt">${article.excerpt}</div>
                        <div class="mt-3">
                            <a href="${article.url}" class="text-indigo-600 hover:text-indigo-800 text-sm font-medium">
                                阅读全文 →
                            </a>
                        </div>
                    </div>
                `;
                
                container.appendChild(timelineItem);
            });
        }

        // 初始化热力图
        function initializeHeatmap() {
            // 生成年份标签
            const monthLabels = document.getElementById('monthLabels');
            const months = ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'];
            
            months.forEach((month, index) => {
                const label = document.createElement('div');
                label.textContent = month;
                label.style.gridColumn = Math.floor(index * 4.4) + 1;
                monthLabels.appendChild(label);
            });
            
            // 年份切换
            document.getElementById('prevYear').addEventListener('click', () => {
                currentYear--;
                renderHeatmap();
            });
            
            document.getElementById('nextYear').addEventListener('click', () => {
                currentYear++;
                renderHeatmap();
            });
            
            renderHeatmap();
        }

        // 渲染热力图
        function renderHeatmap() {
            const grid = document.getElementById('heatmapGrid');
            const yearElement = document.getElementById('heatmapYear');
            
            yearElement.textContent = currentYear;
            grid.innerHTML = '';
            
            // 获取当年的文章数据
            const yearArticles = currentFilter ? 
                filteredArticles.filter(article => new Date(article.date).getFullYear() === currentYear) :
                articles.filter(article => new Date(article.date).getFullYear() === currentYear);
            
            // 创建日期数据映射
            const dateMap = {};
            yearArticles.forEach(article => {
                const date = article.date;
                dateMap[date] = (dateMap[date] || 0) + 1;
            });
            
            // 生成一年的格子
            const startDate = new Date(currentYear, 0, 1);
            const endDate = new Date(currentYear, 11, 31);
            
            // 计算开始的星期几（调整为周一开始）
            const startDay = startDate.getDay() === 0 ? 6 : startDate.getDay() - 1;
            
            // 添加前面的空格子
            for (let i = 0; i < startDay; i++) {
                const emptyCell = document.createElement('div');
                emptyCell.className = 'heatmap-cell';
                emptyCell.style.visibility = 'hidden';
                grid.appendChild(emptyCell);
            }
            
            // 生成每天的格子
            const currentDate = new Date(startDate);
            while (currentDate <= endDate) {
                const cell = document.createElement('div');
                cell.className = 'heatmap-cell';
                
                const dateStr = currentDate.toISOString().split('T')[0];
                const count = dateMap[dateStr] || 0;
                
                // 设置颜色级别
                let level = 0;
                if (count >= 1) level = 1;
                if (count >= 2) level = 2;
                if (count >= 3) level = 3;
                if (count >= 4) level = 4;
                
                cell.dataset.level = level;
                cell.dataset.date = dateStr;
                cell.title = `${dateStr}: ${count} 篇文章`;
                
                // 添加点击事件
                cell.addEventListener('click', () => {
                    showArticlesForDate(dateStr);
                });
                
                grid.appendChild(cell);
                currentDate.setDate(currentDate.getDate() + 1);
            }
        }

        // 显示指定日期的文章
        function showArticlesForDate(dateStr) {
            const articlesForDate = filteredArticles.filter(article => article.date === dateStr);
            
            if (articlesForDate.length === 0) return;
            
            const articleList = document.getElementById('articleList');
            const selectedDate = document.getElementById('selectedDate');
            const articleContainer = document.getElementById('articleContainer');
            
            selectedDate.textContent = dateStr;
            articleContainer.innerHTML = '';
            
            articlesForDate.forEach(article => {
                const card = document.createElement('div');
                card.className = 'bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow';
                card.innerHTML = `
                    <h4 class="font-semibold text-gray-800 mb-2">${article.title}</h4>
                    <p class="text-sm text-gray-600 mb-3">${article.excerpt}</p>
                    <div class="flex justify-between items-center">
                        <span class="text-xs bg-indigo-100 text-indigo-800 px-2 py-1 rounded">${article.category}</span>
                        <a href="${article.url}" class="text-indigo-600 hover:text-indigo-800 text-sm">阅读 →</a>
                    </div>
                `;
                articleContainer.appendChild(card);
            });
            
            articleList.classList.remove('hidden');
        }

        // 更新统计信息
        function updateStats() {
            const totalPosts = document.getElementById('totalPosts');
            const activeDays = document.getElementById('activeDays');
            const currentStreak = document.getElementById('currentStreak');
            const longestStreak = document.getElementById('longestStreak');
            
            totalPosts.textContent = filteredArticles.length;
            
            // 计算活跃天数
            const uniqueDates = new Set(filteredArticles.map(article => article.date));
            activeDays.textContent = uniqueDates.size;
            
            // 计算连续天数（简化版本）
            const sortedDates = Array.from(uniqueDates).sort();
            let streak = 1;
            let maxStreak = 1;
            
            for (let i = 1; i < sortedDates.length; i++) {
                const prevDate = new Date(sortedDates[i - 1]);
                const currDate = new Date(sortedDates[i]);
                const diffDays = (currDate - prevDate) / (1000 * 60 * 60 * 24);
                
                if (diffDays === 1) {
                    streak++;
                } else {
                    maxStreak = Math.max(maxStreak, streak);
                    streak = 1;
                }
            }
            
            longestStreak.textContent = maxStreak;
            currentStreak.textContent = streak > 1 ? streak : 0;
        }
    </script>
</body>
</html>